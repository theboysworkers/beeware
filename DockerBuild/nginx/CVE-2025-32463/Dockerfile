FROM theb0ys/base:latest

# Installa dipendenze e nginx
RUN apt-get update && \
    apt-get install -y nginx sudo build-essential libpam0g-dev libssl-dev gcc wget && \
    apt-get clean && \
    rm -rf /var/lib/apt/lists/*

# Compila e installa sudo da sorgente, poi rimuove i file sorgenti
RUN wget https://www.sudo.ws/dist/sudo-1.9.14.tar.gz && \
    tar xzf sudo-1.9.14.tar.gz && \
    cd sudo-1.9.14 && \
    ./configure --prefix=/usr/local && \
    make && \
    make install && \
    rm /bin/sudo /bin/sudoedit /bin/sudoreplay && \
    cp /usr/local/bin/sudo /bin && \
    cp /usr/local/bin/sudoreplay /bin && \
    cp /usr/local/bin/sudoedit /bin && \
    cd .. && \
    rm -rf sudo-1.9.14 sudo-1.9.14.tar.gz
